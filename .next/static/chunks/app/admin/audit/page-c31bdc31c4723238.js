(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[530],{63:(e,t,r)=>{"use strict";var s=r(7260);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},733:(e,t,r)=>{Promise.resolve().then(r.bind(r,4211))},1289:(e,t,r)=>{"use strict";r.d(t,{N:()=>s});let s=(0,r(2373).UU)("https://mhurrctigejpeawlyatp.supabase.co","sb_publishable_toVptLBJfm_pkub8IB0NxQ_2vYMB-UH",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}})},1847:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var s=r(2115);let a=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},l=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let d=(0,s.forwardRef)((e,t)=>{let{color:r="currentColor",size:a=24,strokeWidth:d=2,absoluteStrokeWidth:i,className:u="",children:c,iconNode:o,...m}=e;return(0,s.createElement)("svg",{ref:t,...n,width:a,height:a,stroke:r,strokeWidth:i?24*Number(d)/Number(a):d,className:l("lucide",u),...!c&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(m)&&{"aria-hidden":"true"},...m},[...o.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(c)?c:[c]])}),i=(e,t)=>{let r=(0,s.forwardRef)((r,n)=>{let{className:i,...u}=r;return(0,s.createElement)(d,{ref:n,iconNode:t,className:l("lucide-".concat(a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),i),...u})});return r.displayName=a(e),r}},4211:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var s=r(5155),a=r(2115),l=r(63),n=r(6948),d=r(7910),i=r(1289),u=r(4790);function c(){let e=(0,l.useRouter)(),{user:t,loading:r}=(0,u.w)(),[c,o]=(0,a.useState)(!0),[m,x]=(0,a.useState)(!1),[f,p]=(0,a.useState)(null),[h,g]=(0,a.useState)([]);return((0,a.useEffect)(()=>{r||t||e.replace("/login")},[r,t,e]),(0,a.useEffect)(()=>{(async()=>{if(!t)return;o(!0),p(null);let{data:e}=await i.N.from("profiles").select("role").eq("id",t.id).maybeSingle();if((null==e?void 0:e.role)!="admin"){x(!1),o(!1);return}x(!0);let{data:r,error:s}=await i.N.from("audit_logs").select("*").order("created_at",{ascending:!1}).limit(30);if(s){p(s.message),o(!1);return}g(null!=r?r:[]),o(!1)})()},[t]),r||c)?(0,s.jsx)("div",{className:"p-8 max-w-7xl mx-auto text-muted-foreground uppercase tracking-[0.3em] text-xs",children:"Loading audit log"}):m?(0,s.jsxs)("div",{className:"p-8 max-w-5xl mx-auto space-y-8",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 text-xs uppercase tracking-[0.3em] text-muted-foreground",children:[(0,s.jsx)("span",{className:"h-1 w-10 bg-primary/70"}),"Security Ledger"]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Audit Log"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Every admin action, quietly recorded."})]}),(0,s.jsx)(d.A,{size:20,className:"text-primary"})]}),f&&(0,s.jsx)("div",{className:"border border-border bg-card/60 text-muted-foreground text-sm px-4 py-3 rounded-2xl",children:f}),(0,s.jsx)("div",{className:"space-y-4",children:0===h.length?(0,s.jsx)(n.Zp,{className:"bg-card border-border",children:(0,s.jsx)(n.Wu,{className:"text-muted-foreground p-6",children:"No audit events yet."})}):h.map(e=>{var t,r,a;return(0,s.jsx)(n.Zp,{className:"bg-card border-border",children:(0,s.jsxs)(n.Wu,{className:"p-6 flex flex-col gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs uppercase tracking-[0.2em] text-muted-foreground",children:[(0,s.jsx)("span",{children:e.action}),(0,s.jsx)("span",{children:new Date(e.created_at).toLocaleString()})]}),(0,s.jsx)("div",{className:"text-foreground font-medium",children:null!=(t=e.detail)?t:"Action recorded"}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:[null!=(r=e.target_type)?r:"system"," ",null!=(a=e.target_id)?a:""]})]})},e.id)})})]}):(0,s.jsx)("div",{className:"p-8 max-w-3xl mx-auto",children:(0,s.jsxs)(n.Zp,{className:"bg-card border-border",children:[(0,s.jsx)(n.aR,{children:(0,s.jsx)(n.ZB,{className:"text-foreground",children:"Access restricted"})}),(0,s.jsx)(n.Wu,{className:"text-muted-foreground",children:"Admin access is required to view audit logs."})]})})}},4269:(e,t,r)=>{"use strict";r.d(t,{cn:()=>l});var s=r(2821),a=r(5889);function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}},4790:(e,t,r)=>{"use strict";r.d(t,{w:()=>l});var s=r(2115),a=r(1289);function l(){let[e,t]=(0,s.useState)(null),[r,l]=(0,s.useState)(null),[n,d]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{let e=!0;(async()=>{let{data:r,error:s}=await a.N.auth.getSession();if(e){if(s)t(null),l(null);else{var n,i,u;t(null!=(i=r.session)?i:null),l(null!=(u=null==(n=r.session)?void 0:n.user)?u:null)}d(!1)}})();let{data:r}=a.N.auth.onAuthStateChange((e,r)=>{var s;t(null!=r?r:null),l(null!=(s=null==r?void 0:r.user)?s:null)});return()=>{e=!1,r.subscription.unsubscribe()}},[]),{session:e,user:r,loading:n}}},6948:(e,t,r)=>{"use strict";r.d(t,{BT:()=>u,Wu:()=>c,ZB:()=>i,Zp:()=>n,aR:()=>d});var s=r(5155),a=r(2115),l=r(4269);let n=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("rounded-xl border bg-card text-card-foreground shadow",r),...a})});n.displayName="Card";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",r),...a})});d.displayName="CardHeader";let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("font-semibold leading-none tracking-tight",r),...a})});i.displayName="CardTitle";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",r),...a})});u.displayName="CardDescription";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",r),...a})});c.displayName="CardContent",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",r),...a})}).displayName="CardFooter"},7910:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(1847).A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])}},e=>{e.O(0,[373,909,441,493,358],()=>e(e.s=733)),_N_E=e.O()}]);