(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[93],{63:(e,t,r)=>{"use strict";var s=r(7260);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},534:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(1847).A)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},610:(e,t,r)=>{Promise.resolve().then(r.bind(r,3159))},906:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(1847).A)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},1289:(e,t,r)=>{"use strict";r.d(t,{N:()=>s});let s=(0,r(2373).UU)("https://mhurrctigejpeawlyatp.supabase.co","sb_publishable_toVptLBJfm_pkub8IB0NxQ_2vYMB-UH",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}})},1847:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var s=r(2115);let a=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},l=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,s.forwardRef)((e,t)=>{let{color:r="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:d,className:c="",children:o,iconNode:u,...m}=e;return(0,s.createElement)("svg",{ref:t,...n,width:a,height:a,stroke:r,strokeWidth:d?24*Number(i)/Number(a):i,className:l("lucide",c),...!o&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(m)&&{"aria-hidden":"true"},...m},[...u.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(o)?o:[o]])}),d=(e,t)=>{let r=(0,s.forwardRef)((r,n)=>{let{className:d,...c}=r;return(0,s.createElement)(i,{ref:n,iconNode:t,className:l("lucide-".concat(a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),d),...c})});return r.displayName=a(e),r}},3159:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var s=r(5155),a=r(2115),l=r(63),n=r(6948),i=r(906),d=r(534);let c=(0,r(1847).A)("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);var o=r(1289),u=r(4790);function m(){let e=(0,l.useRouter)(),{user:t,loading:r}=(0,u.w)(),[m,x]=(0,a.useState)(!0),[h,f]=(0,a.useState)(!1),[p,g]=(0,a.useState)(null),[v,N]=(0,a.useState)({users:"--",events:"--",news:"--",library:"--",joins:"--"}),[b,j]=(0,a.useState)([]);(0,a.useEffect)(()=>{r||t||e.replace("/login")},[r,t,e]),(0,a.useEffect)(()=>{(async()=>{var e,r,s,a,l,n;if(!t)return;x(!0),g(null);let{data:i,error:d}=await o.N.from("profiles").select("role").eq("id",t.id).maybeSingle();if(d){g(d.message),x(!1);return}if((null==i?void 0:i.role)!=="admin"){f(!1),x(!1);return}f(!0);let c=new Date(Date.now()-5184e5),[{count:u},{count:m},{count:h},{count:p},{count:v},{data:b}]=await Promise.all([o.N.from("profiles").select("id",{count:"exact",head:!0}),o.N.from("events").select("id",{count:"exact",head:!0}),o.N.from("news").select("id",{count:"exact",head:!0}),o.N.from("library_paths").select("id",{count:"exact",head:!0}),o.N.from("join_requests").select("id",{count:"exact",head:!0}),o.N.from("join_requests").select("created_at").gte("created_at",c.toISOString())]);b||g("Unable to load join request history.");let y=new Map;(null!=b?b:[]).forEach(e=>{var t;let r=new Date(e.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric"});y.set(r,(null!=(t=y.get(r))?t:0)+1)});let w=[];for(let t=6;t>=0;t-=1){let r=new Date(Date.now()-24*t*36e5).toLocaleDateString("en-US",{month:"short",day:"numeric"});w.push({day:r,count:null!=(e=y.get(r))?e:0})}N({users:null!=(r=null==u?void 0:u.toString())?r:"--",events:null!=(s=null==m?void 0:m.toString())?s:"--",news:null!=(a=null==h?void 0:h.toString())?a:"--",library:null!=(l=null==p?void 0:p.toString())?l:"--",joins:null!=(n=null==v?void 0:v.toString())?n:"--"}),j(w),x(!1)})()},[t]);let y=(0,a.useMemo)(()=>Math.max(...b.map(e=>e.count),1),[b]);return r||m?(0,s.jsx)("div",{className:"p-8 max-w-7xl mx-auto text-muted-foreground uppercase tracking-[0.3em] text-xs",children:"Loading analytics"}):h?(0,s.jsxs)("div",{className:"p-8 max-w-7xl mx-auto space-y-8",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 text-xs uppercase tracking-[0.3em] text-muted-foreground",children:[(0,s.jsx)("span",{className:"h-1 w-10 bg-primary/70"}),"Signal Readout"]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Analytics"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Quiet metrics for steady decisions."})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 text-xs uppercase tracking-[0.25em] text-muted-foreground",children:[(0,s.jsx)(i.A,{size:14,className:"text-primary"}),"Live"]})]}),p&&(0,s.jsx)("div",{className:"border border-border bg-card/60 text-muted-foreground text-sm px-4 py-3 rounded-2xl",children:p}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:[{label:"Members",value:v.users},{label:"Events",value:v.events},{label:"News",value:v.news},{label:"Library",value:v.library},{label:"Join Requests",value:v.joins}].map(e=>(0,s.jsxs)(n.Zp,{className:"bg-card border-border",children:[(0,s.jsx)(n.aR,{className:"pb-2",children:(0,s.jsx)("span",{className:"text-muted-foreground text-sm font-medium",children:e.label})}),(0,s.jsx)(n.Wu,{children:(0,s.jsx)("div",{className:"text-2xl font-bold text-foreground",children:e.value})})]},e.label))}),(0,s.jsxs)(n.Zp,{className:"bg-card border-border",children:[(0,s.jsx)(n.aR,{children:(0,s.jsxs)(n.ZB,{className:"text-foreground flex items-center gap-3",children:[(0,s.jsx)(d.A,{size:18,className:"text-primary"}),"Weekly Join Requests"]})}),(0,s.jsx)(n.Wu,{children:(0,s.jsx)("div",{className:"grid grid-cols-7 gap-3 items-end h-40",children:b.map(e=>(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,s.jsx)("div",{className:"w-full rounded-full bg-primary/40",style:{height:"".concat(e.count/y*100,"%")}}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:e.day})]},e.day))})})]}),(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,s.jsxs)(n.Zp,{className:"bg-card border-border",children:[(0,s.jsx)(n.aR,{children:(0,s.jsxs)(n.ZB,{className:"text-foreground flex items-center gap-3",children:[(0,s.jsx)(c,{size:18,className:"text-primary"}),"Data Integrity"]})}),(0,s.jsx)(n.Wu,{className:"text-muted-foreground",children:"All event, news, and library entries are syncing from Supabase. Refresh intervals stay under 60 seconds."})]}),(0,s.jsxs)(n.Zp,{className:"bg-card border-border",children:[(0,s.jsx)(n.aR,{children:(0,s.jsx)(n.ZB,{className:"text-foreground",children:"Focus"})}),(0,s.jsx)(n.Wu,{className:"text-muted-foreground",children:"Join-request velocity suggests when to schedule onboarding sessions and mentorship matching."})]})]})]}):(0,s.jsx)("div",{className:"p-8 max-w-3xl mx-auto",children:(0,s.jsxs)(n.Zp,{className:"bg-card border-border",children:[(0,s.jsx)(n.aR,{children:(0,s.jsx)(n.ZB,{className:"text-foreground",children:"Access restricted"})}),(0,s.jsx)(n.Wu,{className:"text-muted-foreground",children:"Admin access is required to view analytics."})]})})}},4269:(e,t,r)=>{"use strict";r.d(t,{cn:()=>l});var s=r(2821),a=r(5889);function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}},4790:(e,t,r)=>{"use strict";r.d(t,{w:()=>l});var s=r(2115),a=r(1289);function l(){let[e,t]=(0,s.useState)(null),[r,l]=(0,s.useState)(null),[n,i]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{let e=!0;(async()=>{let{data:r,error:s}=await a.N.auth.getSession();if(e){if(s)t(null),l(null);else{var n,d,c;t(null!=(d=r.session)?d:null),l(null!=(c=null==(n=r.session)?void 0:n.user)?c:null)}i(!1)}})();let{data:r}=a.N.auth.onAuthStateChange((e,r)=>{var s;t(null!=r?r:null),l(null!=(s=null==r?void 0:r.user)?s:null)});return()=>{e=!1,r.subscription.unsubscribe()}},[]),{session:e,user:r,loading:n}}},6948:(e,t,r)=>{"use strict";r.d(t,{BT:()=>c,Wu:()=>o,ZB:()=>d,Zp:()=>n,aR:()=>i});var s=r(5155),a=r(2115),l=r(4269);let n=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("rounded-xl border bg-card text-card-foreground shadow",r),...a})});n.displayName="Card";let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",r),...a})});i.displayName="CardHeader";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("font-semibold leading-none tracking-tight",r),...a})});d.displayName="CardTitle";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",r),...a})});c.displayName="CardDescription";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",r),...a})});o.displayName="CardContent",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",r),...a})}).displayName="CardFooter"}},e=>{e.O(0,[373,909,441,493,358],()=>e(e.s=610)),_N_E=e.O()}]);